<div
    class="flex min-w-0 flex-auto flex-col items-center sm:flex-row sm:justify-center md:items-start md:justify-start"
>
    <div
        class="relative hidden h-full flex-auto items-center justify-center overflow-hidden bg-gray-800 p-16 dark:border-r md:flex lg:px-28"
    >
        <!-- Background -->
        <!-- Rings -->
        <!-- prettier-ignore -->
        <svg class="absolute inset-0 pointer-events-none"
             viewBox="0 0 960 540" width="100%" height="100%" preserveAspectRatio="xMidYMax slice" xmlns="http://www.w3.org/2000/svg">
            <g class="text-gray-700 opacity-25" fill="none" stroke="currentColor" stroke-width="100">
                <circle r="234" cx="196" cy="23"></circle>
                <circle r="234" cx="790" cy="491"></circle>
            </g>
        </svg>
        <!-- Dots -->
        <!-- prettier-ignore -->
        <svg class="absolute -top-16 -right-16 text-gray-700"
             viewBox="0 0 220 192" width="220" height="192" fill="none">
            <defs>
                <pattern id="837c3e70-6c3a-44e6-8854-cc48c737b659" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
                    <rect x="0" y="0" width="4" height="4" fill="currentColor"></rect>
                </pattern>
            </defs>
            <rect width="220" height="192" fill="url(#837c3e70-6c3a-44e6-8854-cc48c737b659)"></rect>
        </svg>
        <!-- Content -->
        <div class="relative z-10 w-full max-w-2xl">
            <div class="text-7xl font-bold leading-none text-gray-100">
                <div>Welcome to</div>
                <div>our community</div>
            </div>
            <div class="mt-6 text-lg leading-6 tracking-tight text-gray-400">
                Fuse helps developers to build organized and well coded
                dashboards full of beautiful and rich modules. Join us and start
                building your application today.
            </div>
            <div class="mt-8 flex items-center">
                <div class="flex flex-0 items-center -space-x-1.5">
                    <img
                        class="h-10 w-10 flex-0 rounded-full object-cover ring-4 ring-gray-800 ring-offset-1 ring-offset-gray-800"
                        src="images/avatars/female-18.jpg"
                    />
                    <img
                        class="h-10 w-10 flex-0 rounded-full object-cover ring-4 ring-gray-800 ring-offset-1 ring-offset-gray-800"
                        src="images/avatars/female-11.jpg"
                    />
                    <img
                        class="h-10 w-10 flex-0 rounded-full object-cover ring-4 ring-gray-800 ring-offset-1 ring-offset-gray-800"
                        src="images/avatars/male-09.jpg"
                    />
                    <img
                        class="h-10 w-10 flex-0 rounded-full object-cover ring-4 ring-gray-800 ring-offset-1 ring-offset-gray-800"
                        src="images/avatars/male-16.jpg"
                    />
                </div>
                <div class="ml-4 font-medium tracking-tight text-gray-400">
                    More than 17k people joined us, it's your turn
                </div>
            </div>
        </div>
    </div>
    <div
        class="w-full px-4 py-8 sm:bg-card sm:w-auto sm:rounded-2xl sm:p-12 sm:shadow md:flex md:h-full md:justify-end md:rounded-none md:p-16 md:pt-24 md:shadow-none"
    >
        <div class="mx-auto w-full max-w-80 sm:mx-0 sm:w-80">
            <!-- Logo -->
            <div class="w-12">
                <img src="images/logo/logo.svg" />
            </div>

            <!-- Title -->
            <div
                class="mt-8 text-4xl font-extrabold leading-tight tracking-tight"
            >
                Sign up
            </div>
            <div class="mt-0.5 flex items-baseline font-medium">
                <div>Already have an account?</div>
                <a
                    class="ml-1 text-primary-500 hover:underline"
                    [routerLink]="['/sign-in']"
                >Sign in
                </a>
            </div>

            <!-- Alert -->
            @if (showAlert) {
                <fuse-alert
                    class="mt-8"
                    [appearance]="'outline'"
                    [showIcon]="false"
                    [type]="alert.type"
                    [@shake]="alert.type === 'error'"
                >
                    {{ alert.message }}
                </fuse-alert>
            }

            <!-- Sign Up form -->
            <form [formGroup]="registerForm" novalidate (keydown.enter)="register()">
                <!-- Account type selection hidden - only Individual allowed -->
                <div class="mb-6">
                    <mat-radio-group class="flex items-center justify-center gap-6" formControlName="accountType">
                        <mat-radio-button value="C" class="text-base font-medium">Individual</mat-radio-button>
                        <mat-radio-button value="A" class="text-base font-medium">Intermediary</mat-radio-button>
                    </mat-radio-group>
                </div>
                <div *ngIf="registerForm.get('accountType').value === 'C'">
                    <div class="space-y-4">
                        <div>
                            <label class="mb-2 block text-sm font-medium text-gray-700">Full Name *</label>
                            <input
                                type="text"
                                [class]="'w-full rounded-lg px-4 py-3 text-sm border focus:outline-none focus:ring-2 focus:border-transparent ' +
                   (registerForm.get('fullName')?.invalid && registerForm.get('fullName')?.touched ?
                   'border-red-500 focus:ring-red-500' : 'border-gray-300 focus:ring-sky-500') +
                   (registerForm.get('fullName')?.value ? ' font-bold' : '')"
                                formControlName="fullName"
                                placeholder="John Doe"/>
                            <div *ngIf="registerForm.get('fullName')?.invalid && registerForm.get('fullName')?.touched" class="mt-1.5 text-xs text-red-500">
                                <span *ngIf="registerForm.get('fullName')?.errors?.['required']">Full name is required</span>
                                <span *ngIf="registerForm.get('fullName')?.errors?.['fullNameInvalid']">Enter at least two names</span>
                            </div>
                        </div>

                        <div>
                            <label class="mb-2 block text-sm font-medium text-gray-700">Email Address *</label>
                            <input
                                type="email"
                                [class]="'w-full rounded-lg px-4 py-3 text-sm border focus:outline-none focus:ring-2 focus:border-transparent ' +
                   (registerForm.get('email')?.invalid && registerForm.get('email')?.touched ?
                   'border-red-500 focus:ring-red-500' : 'border-gray-300 focus:ring-sky-500') +
                   (registerForm.get('email')?.value ? ' font-bold' : '')"
                                formControlName="email"
                                placeholder="your-email@example.com"/>
                            <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" class="mt-1.5 text-xs text-red-500">
                                <span *ngIf="registerForm.get('email')?.errors?.['required']">Email is required</span>
                                <span *ngIf="registerForm.get('email')?.errors?.['email']">Enter a valid email</span>
                            </div>
                        </div>
                        <div>
                            <label class="mb-2 block text-sm font-medium text-gray-700">KRA PIN *</label>
                            <input
                                type="text"
                                [class]="'w-full rounded-lg px-4 py-3 text-sm border focus:outline-none focus:ring-2 focus:border-transparent ' +
                   (registerForm.get('kraPin')?.invalid && registerForm.get('kraPin')?.touched ?
                   'border-red-500 focus:ring-red-500' : 'border-gray-300 focus:ring-sky-500') +
                   (registerForm.get('kraPin')?.value ? ' font-bold' : '')"
                                formControlName="kraPin"
                                placeholder="A123456789M"
                                style="text-transform: uppercase;"
                                (input)="onKraPinChange($event)"
                                maxlength="11"/>
                            <div *ngIf="registerForm.get('kraPin')?.invalid && registerForm.get('kraPin')?.touched" class="mt-1.5 text-xs text-red-500">
                                <span *ngIf="registerForm.get('kraPin')?.errors?.['required']">KRA PIN is required</span>
                                <span *ngIf="registerForm.get('kraPin')?.errors?.['kraPinInvalid']">Format: A123456789M</span>
                            </div>
                        </div>

                        <div>
                            <label class="mb-2 block text-sm font-medium text-gray-700">Phone Number *</label>
                            <input
                                type="tel"
                                [class]="'w-full rounded-lg px-4 py-3 text-sm border focus:outline-none focus:ring-2 focus:border-transparent ' +
                   (registerForm.get('phoneNumber')?.invalid && registerForm.get('phoneNumber')?.touched ?
                   'border-red-500 focus:ring-red-500' : 'border-gray-300 focus:ring-sky-500') +
                   (registerForm.get('phoneNumber')?.value ? ' font-bold' : '')"
                                formControlName="phoneNumber"
                                placeholder="+254712345678"
                                (input)="onPhoneNumberChange($event)"
                                maxlength="13"/>
                            <div *ngIf="registerForm.get('phoneNumber')?.invalid && registerForm.get('phoneNumber')?.touched" class="mt-1.5 text-xs text-red-500">
                                <span *ngIf="registerForm.get('phoneNumber')?.errors?.['required']">Phone is required</span>
                                <span *ngIf="registerForm.get('phoneNumber')?.errors?.['phoneNumberInvalid']">Use +254 format</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="registerForm.get('accountType').value === 'A'">
                    <div class="space-y-4">
                        <div>
                            <label class="mb-2 block text-sm font-medium text-gray-700">Intermediary - IRA Number</label>
                            <input type="text" class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-sm text-gray-900 placeholder-gray-400 transition-colors focus:border-sky-500 focus:outline-none focus:ring-2 focus:ring-sky-500/20" formControlName="iraNumber" placeholder="IRA Number"/>
                        </div>
                        <div>
                            <label class="mb-2 block text-sm font-medium text-gray-700">Email Address</label>
                            <input type="email" class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-sm text-gray-900 placeholder-gray-400 transition-colors focus:border-sky-500 focus:outline-none focus:ring-2 focus:ring-sky-500/20" formControlName="email" placeholder="your-email@example.com"/>
                        </div>
                        <div>
                            <label class="mb-2 block text-sm font-medium text-gray-700">KRA PIN</label>
                            <input type="text" class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-sm text-gray-900 placeholder-gray-400 transition-colors focus:border-sky-500 focus:outline-none focus:ring-2 focus:ring-sky-500/20" formControlName="pinNumber" placeholder="A123456789M"/>
                        </div>
                    </div>
                </div>
                <div class="mb-4">
                    <label class="mb-2 block text-sm font-medium text-gray-700">Password</label>
                    <div class="relative">
                        <input [type]="showPassword ? 'text' : 'password'" class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3.5 pr-12 text-sm text-gray-900 placeholder-gray-400 transition-colors focus:border-sky-500 focus:outline-none focus:ring-2 focus:ring-sky-500/20" [class.border-red-300]="password?.invalid && password?.touched" formControlName="password" placeholder="Create a strong password" required/>
                        <button type="button" class="absolute inset-y-0 right-0 flex items-center pr-4 text-gray-400 hover:text-gray-600 transition-colors" (click)="togglePasswordVisibility()">
                            <mat-icon class="text-xl">{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                        </button>
                    </div>
                    <div *ngIf="password?.touched && password?.value" class="mt-1">
                        <ul class="space-y-0.5 text-xs text-gray-500">
                            <li class="flex items-center" [class.text-green-600]="hasMinLength(password.value)">
                                <mat-icon class="text-xs mr-1">{{ hasMinLength(password.value) ? 'check_circle' : 'cancel' }}</mat-icon>
                                <span class="text-xs">At least 8 characters</span>
                            </li>
                            <li class="flex items-center" [class.text-green-600]="hasLowercase(password.value)">
                                <mat-icon class="text-xs mr-1">{{ hasLowercase(password.value) ? 'check_circle' : 'cancel' }}</mat-icon>
                                <span class="text-xs">One lowercase letter</span>
                            </li>
                            <li class="flex items-center" [class.text-green-600]="hasUppercase(password.value)">
                                <mat-icon class="text-xs mr-1">{{ hasUppercase(password.value) ? 'check_circle' : 'cancel' }}</mat-icon>
                                <span class="text-xs">One uppercase letter</span>
                            </li>
                            <li class="flex items-center" [class.text-green-600]="hasNumber(password.value)">
                                <mat-icon class="text-xs mr-1">{{ hasNumber(password.value) ? 'check_circle' : 'cancel' }}</mat-icon>
                                <span class="text-xs">One number</span>
                            </li>
                            <li class="flex items-center" [class.text-green-600]="hasSpecialChar(password.value)">
                                <mat-icon class="text-xs mr-1">{{ hasSpecialChar(password.value) ? 'check_circle' : 'cancel' }}</mat-icon>
                                <span class="text-xs">One special character (&#64;$!%*?&)</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="mb-4">
                    <label class="mb-2 block text-sm font-medium text-gray-700">Confirm Password</label>
                    <div class="relative">
                        <input [type]="showPassword ? 'text' : 'password'" class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3.5 pr-12 text-sm text-gray-900 placeholder-gray-400 transition-colors focus:border-sky-500 focus:outline-none focus:ring-2 focus:ring-sky-500/20" [class.border-red-300]="registerForm.errors?.['passwordMismatch'] && confirmPassword?.touched" formControlName="confirmPassword" placeholder="Confirm your password" required/>
                        <button type="button" class="absolute inset-y-0 right-0 flex items-center pr-4 text-gray-400 hover:text-gray-600 transition-colors" (click)="togglePasswordVisibility()">
                            <mat-icon class="text-xl">{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                        </button>
                    </div>
                    <p class="mt-1.5 text-xs text-red-500" *ngIf="registerForm.errors?.['passwordMismatch'] && confirmPassword?.touched">Passwords do not match</p>
                </div>
                <div class="mb-5 flex items-center">
                    <mat-checkbox formControlName="agreementAccepted" id="register-agreement" class="flex-shrink-0"></mat-checkbox>
                    <label for="register-agreement" class="ml-2 text-xs sm:text-sm text-gray-600">I agree to the <a href="#" class="font-medium text-sky-500 hover:text-sky-600 hover:underline" (click)="showTermsModal = true; $event.preventDefault()">Terms of Service</a> and <a href="#" class="font-medium text-sky-500 hover:text-sky-600 hover:underline" (click)="showDataPrivacyModal = true; $event.preventDefault()">Data Privacy Policy</a>.</label>
                </div>
                <button type="button" (click)="register()" class="w-full rounded-lg py-3.5 text-base font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2" [ngClass]="{ 'bg-sky-500 text-white hover:bg-sky-600 focus:ring-sky-500': registerForm.valid, 'cursor-not-allowed bg-gray-200 text-gray-400': registerForm.invalid || registerForm.disabled }" [disabled]="registerForm.invalid || registerForm.disabled">
                    <ng-container *ngIf="!registerForm.disabled; else registering">Create Account</ng-container>
                    <ng-template #registering>
                        <div class="flex items-center justify-center">
                            <mat-progress-spinner [diameter]="18" mode="indeterminate" class="mr-2"></mat-progress-spinner>
                            <span>Creating account...</span>
                        </div>
                    </ng-template>
                </button>
            </form>
        </div>
    </div>
</div>
